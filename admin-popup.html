<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>OKcean — 팝업 관리</title>
  <style>
    *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }

    body {
      font-family: 'Georgia', serif;
      background: #f5f4f0;
      color: #1a1a2e;
      min-height: 100vh;
    }

    /* ── Header ── */
    .admin-header {
      background: #1a1a2e;
      color: #f5f4f0;
      padding: 20px 40px;
      display: flex;
      align-items: center;
      justify-content: space-between;
    }
    .admin-header h1 { font-size: 1.1rem; letter-spacing: 0.1em; font-weight: 400; }
    .admin-header a { color: #f5f4f0; text-decoration: none; font-size: 0.85rem; opacity: 0.7; }
    .admin-header a:hover { opacity: 1; }

    /* ── Auth Gate ── */
    #authGate {
      display: flex;
      align-items: center;
      justify-content: center;
      min-height: calc(100vh - 65px);
    }
    .login-box {
      background: #fff;
      padding: 48px 40px;
      width: 360px;
      border: 1px solid #ddd;
    }
    .login-box h2 { font-size: 1rem; font-weight: 400; letter-spacing: 0.08em; margin-bottom: 32px; text-align: center; }
    .login-box input {
      width: 100%;
      padding: 12px 14px;
      border: 1px solid #ccc;
      font-size: 0.9rem;
      margin-bottom: 12px;
      outline: none;
      font-family: inherit;
    }
    .login-box input:focus { border-color: #1a1a2e; }
    .login-box button {
      width: 100%;
      padding: 13px;
      background: #1a1a2e;
      color: #f5f4f0;
      border: none;
      font-size: 0.9rem;
      letter-spacing: 0.08em;
      cursor: pointer;
      font-family: inherit;
      margin-top: 4px;
    }
    .login-box button:hover { background: #2d2d4e; }
    #loginError { color: #c0392b; font-size: 0.82rem; margin-top: 10px; text-align: center; }

    /* ── Main ── */
    #adminMain { display: none; padding: 40px; max-width: 900px; margin: 0 auto; }

    .admin-top {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 32px;
    }
    .admin-top h2 { font-size: 1rem; font-weight: 400; letter-spacing: 0.06em; }

    .btn {
      padding: 10px 22px;
      font-size: 0.85rem;
      letter-spacing: 0.06em;
      cursor: pointer;
      border: none;
      font-family: inherit;
    }
    .btn-primary { background: #1a1a2e; color: #f5f4f0; }
    .btn-primary:hover { background: #2d2d4e; }
    .btn-secondary { background: transparent; color: #1a1a2e; border: 1px solid #1a1a2e; }
    .btn-secondary:hover { background: #1a1a2e; color: #f5f4f0; }
    .btn-danger { background: transparent; color: #c0392b; border: 1px solid #c0392b; }
    .btn-danger:hover { background: #c0392b; color: #fff; }
    .btn:disabled { opacity: 0.5; cursor: not-allowed; }

    /* ── Form ── */
    #popupForm {
      background: #fff;
      padding: 36px;
      border: 1px solid #ddd;
      margin-bottom: 40px;
      display: none;
    }
    #popupForm h3 { font-size: 0.95rem; font-weight: 400; letter-spacing: 0.06em; margin-bottom: 28px; }

    .form-row { margin-bottom: 20px; }
    .form-row label { display: block; font-size: 0.8rem; letter-spacing: 0.06em; color: #666; margin-bottom: 7px; }
    .form-row input[type="text"],
    .form-row input[type="url"],
    .form-row input[type="date"],
    .form-row textarea {
      width: 100%;
      padding: 11px 13px;
      border: 1px solid #ccc;
      font-size: 0.9rem;
      font-family: inherit;
      outline: none;
      background: #fafafa;
    }
    .form-row input:focus,
    .form-row textarea:focus { border-color: #1a1a2e; background: #fff; }
    .form-row textarea { resize: vertical; min-height: 90px; }

    .form-row-2col { display: grid; grid-template-columns: 1fr 1fr; gap: 16px; }

    .form-actions { display: flex; gap: 12px; margin-top: 28px; }

    /* ── Image preview ── */
    #imagePreview {
      margin-top: 10px;
      max-width: 200px;
      max-height: 120px;
      object-fit: cover;
      display: none;
      border: 1px solid #ddd;
    }

    /* ── Popup List ── */
    .popup-list { display: flex; flex-direction: column; gap: 12px; }

    .popup-card {
      background: #fff;
      border: 1px solid #ddd;
      padding: 20px 24px;
      display: flex;
      align-items: center;
      gap: 20px;
    }
    .popup-card__thumb {
      width: 72px;
      height: 54px;
      object-fit: cover;
      flex-shrink: 0;
      border: 1px solid #eee;
      background: #eee;
    }
    .popup-card__thumb-placeholder {
      width: 72px;
      height: 54px;
      background: #eee;
      flex-shrink: 0;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 0.7rem;
      color: #999;
    }
    .popup-card__info { flex: 1; }
    .popup-card__title { font-size: 0.95rem; margin-bottom: 5px; }
    .popup-card__meta { font-size: 0.78rem; color: #888; }
    .popup-card__badge {
      font-size: 0.72rem;
      padding: 3px 9px;
      border-radius: 20px;
      letter-spacing: 0.04em;
    }
    .badge-active { background: #e8f5e9; color: #2e7d32; }
    .badge-inactive { background: #f5f5f5; color: #999; }
    .popup-card__actions { display: flex; gap: 8px; flex-shrink: 0; }

    .empty-state { text-align: center; padding: 60px 0; color: #aaa; font-size: 0.9rem; }

    /* ── Toggle switch ── */
    .toggle {
      position: relative;
      display: inline-block;
      width: 40px;
      height: 22px;
    }
    .toggle input { opacity: 0; width: 0; height: 0; }
    .toggle-slider {
      position: absolute;
      cursor: pointer;
      inset: 0;
      background: #ccc;
      border-radius: 22px;
      transition: 0.2s;
    }
    .toggle-slider::before {
      content: '';
      position: absolute;
      width: 16px;
      height: 16px;
      left: 3px;
      bottom: 3px;
      background: #fff;
      border-radius: 50%;
      transition: 0.2s;
    }
    .toggle input:checked + .toggle-slider { background: #1a1a2e; }
    .toggle input:checked + .toggle-slider::before { transform: translateX(18px); }

    .logout-btn {
      background: none;
      border: none;
      color: #f5f4f0;
      font-size: 0.85rem;
      cursor: pointer;
      opacity: 0.7;
      font-family: inherit;
    }
    .logout-btn:hover { opacity: 1; }
  </style>
</head>
<body>

<header class="admin-header">
  <h1>OKCEAN — POPUP MANAGER</h1>
  <div style="display:flex; gap:20px; align-items:center;">
    <a href="index.html">← 메인으로</a>
    <button class="logout-btn" id="logoutBtn">로그아웃</button>
  </div>
</header>

<!-- 로그인 게이트 -->
<div id="authGate">
  <div class="login-box">
    <h2>ADMIN LOGIN</h2>
    <input type="email" id="loginEmail" placeholder="이메일" />
    <input type="password" id="loginPassword" placeholder="비밀번호" />
    <button id="loginBtn">로그인</button>
    <p id="loginError"></p>
  </div>
</div>

<!-- 관리자 메인 -->
<div id="adminMain">
  <div class="admin-top">
    <h2>팝업 관리</h2>
    <button class="btn btn-primary" id="newPopupBtn">+ 새 팝업 작성</button>
  </div>

  <!-- 작성 / 수정 폼 -->
  <div id="popupForm">
    <h3 id="formHeading">새 팝업 작성</h3>

    <div class="form-row">
      <label>팝업 유형</label>
      <select id="inputType" style="width:100%;padding:11px 13px;border:1px solid #ccc;font-size:0.9rem;font-family:inherit;outline:none;background:#fafafa;">
        <option value="banner">띠배너</option>
        <option value="modal">모달</option>
      </select>
    </div>

    <div class="form-row">
      <label>이미지 업로드</label>
      <input type="file" id="inputImageFile" accept="image/*" style="width:100%;padding:8px 0;font-size:0.85rem;font-family:inherit;" />
      <div id="uploadProgress" style="display:none;margin-top:8px;font-size:0.8rem;color:#666;"></div>
      <div style="margin:10px 0 6px;font-size:0.78rem;color:#999;">또는 이미지 URL 직접 입력</div>
      <input type="url" id="inputImageUrl" placeholder="https://example.com/image.jpg" />
      <img id="imagePreview" alt="미리보기" />
    </div>

    <div class="form-row">
      <label>제목</label>
      <input type="text" id="inputTitle" placeholder="팝업 제목을 입력하세요" />
    </div>

    <div class="form-row">
      <label>내용</label>
      <textarea id="inputBody" placeholder="팝업에 표시될 설명 텍스트를 입력하세요"></textarea>
    </div>

    <div class="form-row form-row-2col">
      <div>
        <label>버튼 텍스트</label>
        <input type="text" id="inputBtnText" placeholder="예: 자세히 보기" />
      </div>
      <div>
        <label>버튼 링크</label>
        <input type="url" id="inputBtnLink" placeholder="https://..." />
      </div>
    </div>

    <div class="form-row form-row-2col">
      <div>
        <label>노출 시작일</label>
        <input type="date" id="inputStartDate" />
      </div>
      <div>
        <label>노출 종료일</label>
        <input type="date" id="inputEndDate" />
      </div>
    </div>

    <div class="form-actions">
      <button class="btn btn-primary" id="saveBtn">저장</button>
      <button class="btn btn-secondary" id="cancelBtn">취소</button>
    </div>
  </div>

  <!-- 팝업 목록 -->
  <div class="popup-list" id="popupList">
    <div class="empty-state">불러오는 중...</div>
  </div>
</div>

<!-- Firebase Compat SDK -->
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-storage-compat.js"></script>
<script src="js/admin-popup.js"></script>
</body>
</html>
